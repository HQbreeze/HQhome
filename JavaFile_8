package KCSJ;

import java.awt.event.*;
import java.sql.*;
import javax.swing.*;
import java.awt.*;

public class Get {
	private JFrame frame;
	private JTextField textField;
	private JPasswordField passwordField;	
	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					Get window = new Get();
					window.frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}
	public Get() {
		in();
	}
	//登录界面
	protected void in() {
		frame = new JFrame();
		frame.setBounds(400, 200, 550, 400);
		Container con = frame.getContentPane();
	    con.setBackground(Color.yellow);		
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		frame.setVisible(true);
		frame.setResizable(false);
		frame.getContentPane().setLayout(null);
		
		JLabel j1=new JLabel("高校团委团员信息管理系统");
		j1.setBounds(137, 5, 280, 150);
		j1.setFont(new Font("宋体", Font.BOLD, 20));
		frame.getContentPane().add(j1);
		
		JLabel lblNewLabel = new JLabel("账    号：");
		lblNewLabel.setBounds(185, 122, 64, 25);
		frame.getContentPane().add(lblNewLabel);
		
		JLabel lblNewLabel2 = new JLabel("密    码：");
		lblNewLabel2.setBounds(185, 173, 64, 25);
		frame.getContentPane().add(lblNewLabel2);
		
		textField = new JTextField();		
		textField.setBounds(236, 123, 120, 25);		
		frame.getContentPane().add(textField);
		textField.setColumns(10);
		
		passwordField = new JPasswordField();
		passwordField.setBounds(236, 173,120, 25);
		frame.getContentPane().add(passwordField);
		
		JButton btnNewButton = new JButton("登录");
		btnNewButton.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {				
				Connection con = DataBaseManager.connectDB("student","root","123456.");
				PreparedStatement ps = null;
				ResultSet rs = null;
				try {
					ps = con.prepareStatement("select * from useradd where ID=? and passwd=?");
					ps.setString(1, textField.getText());
					ps.setString(2, passwordField.getText());
					rs = ps.executeQuery();
					if (rs.next()) {
						StudentSystem.stu();
					    frame.removeNotify();
					} else {
						JOptionPane pane = new JOptionPane("用户或密码错误");
	                     JDialog dialog  = pane.createDialog("警告");
	                     dialog.show();
					}
				} catch (SQLException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
			}		
		});
		//注册按钮
		btnNewButton.setBounds(79, 266, 93, 23);
		frame.getContentPane().add(btnNewButton);
		JButton btnNewButton1 = new JButton("注册");
		btnNewButton1.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				new enroll();
				frame.removeNotify();
			}
		});
		//退出按钮
		btnNewButton1.setBounds(221, 266, 93, 23);
		frame.getContentPane().add(btnNewButton1);
		JButton tc = new JButton("退出");
		tc.setBounds(361, 266, 93, 23);
        frame.getContentPane().add(tc);
        tc.addActionListener(new ActionListener() {    
            @Override
            public void actionPerformed(ActionEvent e) {
                // TODO 自动生成的方法存根
                if(e.getActionCommand().equals("退出")){
                    System.exit(0);
                }
            }
        }); 	
	}
}
